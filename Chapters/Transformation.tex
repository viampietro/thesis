\chapter{The \hilecop{} model-to-text transformation}
\label{chap:transformation}

The aim of this chapter is to present in details the \hilecop{}
model-to-text transformation that we propose to verify as semantic
preserving. The chapter is structured as follows. First, we present,
in Section~\ref{sec:transf-lit-rev}, a literature review of the works
pertaining to transformation functions in the context of formal
verification. The literature review focuses on the expression of
transformation functions and on their implementation. In
Section~\ref{sec:trans-alg}, we detail the \hilecop{} transformation
function in the form of an algorithm. Finally, in
Section~\ref{sec:trans-coq-impl}, we describe the \coq{}
implementation of the algorithm.

\section{Informal presentation of the \hilecop{} transformation}
\label{sec:informal-transf}
\input{Chapters/Transformation/informal-transf}

\section{Expressing transformation functions}
\label{sec:transf-lit-rev}
\input{Chapters/Transformation/lit-rev}

\textsc{Conclusion of the section:} Hard to express our trans. fun. in
a way that facilitate compositional reasoning (if compositional
reasoning is at all possible), partly because component instances are
connected. However, the lit. review pointed out the necessity to keep
a binding between elements of the source models and elements of the
target programs (introduction of the $\gamma$ binder) to enable state
comparison, i.e on which relies the proof of semantic preservation.

\section{The transformation algorithm}
\label{sec:trans-alg}

\bnote{maybe talk about the fact that the transformation algorithm has
  been established by observing the behavior of the current \hilecop{}
  implementation, and through discussions with the \hilecop{} designer
  (a.k.a David Andreu)}

\begin{itemize}
\item Give the model-to-text transformation algorithm\\
  \pnote{give the alg. as established through our meetings, or maybe
    use a simpler alg. (without the generate infos part, maybe too
    much implementation oriented)}
\item Give the formal specification of the transformation, i.e which
  structural properties between SITPN elements and \hvhdl{} constructs\\
  \rnote{don't know if I'll have the time to do that, but it would be
    great to have it, and use it in the proof. Each time the proof
    says ``by construction'', then the reader can refer to the formal
    spec}
\item Give a concrete example of generated \hvhdl{} code from a simple
  SITPN
\end{itemize}

\section{\coq{} implementation of the \hilecop{} model-to-text transformation}
\label{sec:trans-coq-impl}

\pnote{talk about the state-and-error monad, the $\gamma$ binder, the
  use of generic list functions (fold, map, filter, iter\dots)}

\textsc{Conclusion of the chapter:} Our transformation function is not
really expressible in a compositional way as P and T instances are
bound together. It's a specific case of model-to-text
transformation. However, as much as the comparison with other works of
transformation verification holds, we have been trying to inspire
ourselves from the literature to implement the \hilecop{}
model-to-text transformation function in \coq{}.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
